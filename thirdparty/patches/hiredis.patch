diff --git a/fmacros.h b/fmacros.h
index 754a53c..5c10894 100644
--- a/fmacros.h
+++ b/fmacros.h
@@ -11,4 +11,8 @@
 #define _DARWIN_C_SOURCE
 #endif
 
+#if defined(_MSC_VER) && !defined(__clang__) && !defined(strdup)
+#define strdup _strdup
+#endif
+
 #endif
diff --git a/sds.h b/sds.h
index d9b6761..95dad8e 100644
--- a/sds.h
+++ b/sds.h
@@ -40,8 +40,16 @@ typedef long long ssize_t;
 #ifndef __clang__
 #define __attribute__(x)
 #endif
+
+#endif
+
+#if defined(_MSC_VER) && !defined(__clang__)
+#pragma pack(push, 1)
+#pragma push_macro("__attribute__")
+#define __attribute__(A)
 #endif
 
+
 #include <sys/types.h>
 #include <stdarg.h>
 #include <stdint.h>
@@ -79,6 +87,11 @@ struct __attribute__ ((__packed__)) sdshdr64 {
     char buf[];
 };
 
+#if defined(_MSC_VER) && !defined(__clang__)
+#pragma pop_macro("__attribute__")
+#pragma pack(pop)
+#endif
+
 #define SDS_TYPE_5  0
 #define SDS_TYPE_8  1
 #define SDS_TYPE_16 2
